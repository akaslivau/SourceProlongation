<mah:MetroWindow x:Class="SourceProlongation.View.MainWindowView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
        xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
        Title="Продление источников"
        WindowState="Maximized"
        >
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="Closing">
            <i:InvokeCommandAction Command="{Binding WindowClosingCommand}"/>
        </i:EventTrigger>
    </i:Interaction.Triggers>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Menu Grid.Row="0" Grid.ColumnSpan="3">
            <MenuItem Header="Участники">
                <MenuItem Header="Добавить" Command="{Binding AddCommand}"/>
                <MenuItem Header="Удалить" Command="{Binding RemoveCommand}"/>
            </MenuItem>
            <MenuItem Header="Рассчитать значения" Command="{Binding CalculateCommand}"/>
            <MenuItem Header="Итоговые документы">
                <MenuItem Header="Оформить комплект" Command="{Binding CreateDocsCommand}"/>
                <MenuItem Header="Конвертировать в PDF" Command="{Binding ProceedDocsCommand}"/>
                <MenuItem Header="PDF участников в папки" Command="{Binding PartPdfToFoldersCommand}"/>
                <Separator/>
                <MenuItem Header="Программ PDF Антону" Command="{Binding PrintProgToFolderCommand}"/>
            </MenuItem>

            <MenuItem Header="Прочие документы">
                <MenuItem Header="Приглашение" Command="{Binding OfferCommand}"/>
                <MenuItem Header="Пригласить всех" Command="{Binding OfferAllCommand}"/>
                <MenuItem Header="Анкеты для всех" Command="{Binding AnketaAllCommand}"/>
                <Separator/>
                <MenuItem Header="Адреса" Command="{Binding GetAddressesCommand}"/>
                <MenuItem Header="Трек-номера" Command="{Binding GetTrackNumbersCommand}"/>
                <MenuItem Header="Результаты измерений (буфер)" Command="{Binding ClipboardCommand}"/>
                <Separator/>
                <MenuItem Header="Output to PDF" Command="{Binding OutputToPdfCommand}"/>
            </MenuItem>
        </Menu>
        <ListView Grid.Row="1" Grid.Column="0"
                  ItemsSource="{Binding Items}"
                  SelectedItem="{Binding Selected, UpdateSourceTrigger=PropertyChanged}"
                  DisplayMemberPath="DisplayName"
                  />
    </Grid>
</mah:MetroWindow>
